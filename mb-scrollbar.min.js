/*
 * mb-scrollbar v2.2.0
 * Plugin for AngularJS
 * (c) 2014 Matthew Balmer http://mattbalmer.com
 * License: MIT
 */
angular.module("mb-scrollbar",[]).directive("mbScrollbar",function(){return{restrict:"A",transclude:!0,scope:{config:"=mbScrollbar"},template:"<div class='ngscroll-resizable' style='position: relative; width: 100%; height: 100%;'> <div class='ngscroll-container' style='width: 100%; height: 100%;' ng-transclude></div> <div class='ngscroll-scrollbar-container' ng-style='styles.scrollbarContainer'><div class='ngscroll-scrollbar' ng-style='styles.scrollbar'></div></div> </div>",link:function(o,r){function e(o,r){return"horizontal"==h.direction?r:o}function n(o,r){for(var e in r)(r||{}).hasOwnProperty(e)&&(o||{}).hasOwnProperty(e)&&(o[e]="object"==typeof o[e]?n(o[e],r[e]):r[e]);return o}function t(o){var r=o;return s(o)&&(r=o.touches[0]),e(r.screenY,r.screenX)}function s(o){return 0===o.type.indexOf("touch")}function i(o){var r="margin-"+h.position,e=parseInt(m.css(r)||0)+o;l(e)}function l(o){var r="margin-"+h.position,n=Math.min(0,Math.max(o,-w+p)),t=-n/w;m.css(r,n+"px"),v.css(h.position,t*p+h.scrollbar.margin+"px"),g.css(r,e(-n,0)+"px")}function a(){v.css("opacity",0)}function c(){v.css("opacity",1)}function u(){y=!1,h.scrollbar.show||a(),O=new Date}function d(o){return o.preventDefault(),y=!0,angular.element(document).one("mouseup",u),angular.element(document).one("touchcancel",u),angular.element(document).one("touchend",u),s(o)&&c(),M=t(o),T=t(o),S=new Date,!1}function b(o){if(y){o.preventDefault();var r=t(o),e=r-M;e*=h.dragSpeedModifier,M+=e*(f/p),s(o)&&(e*=-1),C=t(o),i(-e)}}var h={autoResize:!1,direction:(o.config||{}).direction||"vertical",scrollbar:{width:6,hoverWidth:8,color:"rgba(0,0,0,.6)",show:!1},scrollbarContainer:{width:12,color:"rgba(0,0,0,.1)"},dragSpeedModifier:1,firefoxModifier:40,scrollTo:(o.config||{}).scrollTo||null};h.dimension=e("height","width"),h.rDimension=e("width","height"),h.position=e("top","left"),h.rPosition=e("right","bottom"),h=n(h,o.config||{}),h.scrollbar.margin=(h.scrollbarContainer.width-h.scrollbar.width)/2,h.scrollbar.hoverMargin=(h.scrollbarContainer.width-h.scrollbar.hoverWidth)/2;var f,m=angular.element(r[0].querySelector(".ngscroll-container")),g=angular.element(r[0].querySelector(".ngscroll-scrollbar-container")),v=angular.element(g.children()[0]),p=0,w=0;o.styles={scrollbar:{position:"absolute",cursor:"default",opacity:h.scrollbar.show?1:0,background:h.scrollbar.color,"border-radius":h.scrollbar.width/2+"px"},scrollbarContainer:{position:"absolute",transition:"background .3s ease-in-out","border-radius":h.scrollbarContainer.width/2+"px"}},v.css(h.rDimension,h.scrollbar.width+"px"),v.css(h.rPosition,h.scrollbar.margin+"px"),v.css(h.position,h.scrollbar.margin+"px"),g.css(h.rPosition,"0"),g.css(h.position,"0"),g.css(h.dimension,"100%"),g.css(h.rDimension,h.scrollbarContainer.width+"px");var x=function(){e(function(){m.css("height","auto"),w=m[0].scrollHeight||0},function(){w=0;for(var o=m.children(),r=0;o.length>r;r++)w+=o[r].offsetWidth})(),p=e(r[0].offsetHeight,r[0].offsetWidth),h.dragSpeedModifier=Math.max(1,1/(f/p)),m.css(h.dimension,w+"px"),p>=w?(w=p,r.addClass("no-scrollbar"),r.removeClass("has-scrollbar"),a()):(r.addClass("has-scrollbar"),r.removeClass("no-scrollbar"),h.scrollbar.show&&c()),f=p/w*p-2*h.scrollbar.margin,v.css(h.dimension,f+"px"),v.css("transition","opacity .3s ease-in-out, border-radius .1s linear, "+h.rDimension+" .1s linear, "+h.rPosition+" .1s linear"),null==h.scrollTo?i(0):"start"==h.scrollTo?l(0):"end"==h.scrollTo?l(-w+p):l(-parseInt(h.scrollTo))};if("function"==typeof MutationObserver){var D=new MutationObserver(function(){setTimeout(function(){x()},200)});D.observe(r[0],{childList:!0,subtree:!0,characterData:!0,attributes:!0})}else h.autoResize===!0&&(m.on("DOMNodeInserted",x),m.on("DOMNodeRemoved",x));o.$on("recalculateMBScrollbars",function(){setTimeout(function(){x()},5)}),o.$on("scrollToMBScrollbars",function(o,r){setTimeout(function(){l(r)},5)}),m.on("mousewheel",function(o){o.preventDefault(),void 0!=o.originalEvent&&(o=o.originalEvent);var r=e(o.wheelDeltaY||o.wheelDelta,o.wheelDeltaX||o.wheelDeltaY||o.wheelDelta);i(r)}),window.navigator.userAgent.toLowerCase().indexOf("firefox")>=0&&m.on("wheel",function(o){o.preventDefault(),void 0!=o.originalEvent&&(o=o.originalEvent);var r=e(o.deltaY,o.deltaX>0?o.deltaX:o.deltaY);return i(-r*h.firefoxModifier),!1});var y,M,T,C,S,O;v.on("mousedown",d),r.on("touchstart",d),angular.element(document).on("mousemove",b),angular.element(document).on("touchmove",b),h.scrollbar.show||(r.on("mouseenter",c),g.on("mouseenter",c),r.on("mouseleave",function(){y||a()})),g.on("mouseenter",function(){g.css("background",h.scrollbarContainer.color),v.css(h.rDimension,h.scrollbar.hoverWidth+"px"),v.css(h.rPosition,h.scrollbar.hoverMargin+"px"),v.css("border-radius",h.scrollbar.hoverWidth/2+"px")}),g.on("mouseleave",function(){g.css("background","none"),v.css(h.rDimension,h.scrollbar.width+"px"),v.css(h.rPosition,h.scrollbar.margin+"px"),v.css("border-radius",h.scrollbar.width/2+"px")}),x()}}}).service("mbScrollbar",function(){this.recalculate=function(o){setTimeout(function(){o.$broadcast("recalculateMBScrollbars")},5)},this.scrollTo=function(o,r){setTimeout(function(){o.$broadcast("scrollToMBScrollbars",r)},5)}});