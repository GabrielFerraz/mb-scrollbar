/*
 * mb-scrollbar v2.0.0
 * Plugin for AngularJS
 * (c) 2014 Matthew Balmer http://mattbalmer.com
 * License: MIT
 */
angular.module("mb-scrollbar",[]).directive("mbScrollbar",function(){return{restrict:"A",transclude:!0,scope:{config:"=mbScrollbar"},template:"<div class='ngscroll-resizable' style='position: relative; width: 100%; height: 100%;'> <div class='ngscroll-container' style='width: 100%; height: 100%;' ng-transclude></div> <div class='ngscroll-scrollbar-container' ng-style='styles.scrollbarContainer'><div class='ngscroll-scrollbar' ng-style='styles.scrollbar'></div></div> </div>",link:function(r,o){function e(r,o){return"horizontal"==a.direction?o:r}function n(r,o){for(var e in o)(o||{}).hasOwnProperty(e)&&(r||{}).hasOwnProperty(e)&&(r[e]="object"==typeof r[e]?n(r[e],o[e]):o[e]);return r}function s(r){var o="margin-"+a.position,e=parseInt(d.css(o)||0)+r;i(e)}function i(r){var o="margin-"+a.position,n=Math.min(0,Math.max(r,-f+h)),s=-n/f;d.css(o,n+"px"),b.css(a.position,s*h+a.scrollbar.margin+"px"),u.css(o,e(-n,0)+"px")}function l(){b.css("opacity",0)}function t(){b.css("opacity",1)}var a={autoResize:!1,direction:(r.config||{}).direction||"vertical",scrollbar:{width:6,hoverWidth:8,color:"rgba(0,0,0,.6)",show:!1},scrollbarContainer:{width:12,color:"rgba(0,0,0,.1)"},dragSpeedModifier:1,firefoxModifier:40,scrollTo:(r.config||{}).scrollTo||null};a.dimension=e("height","width"),a.rDimension=e("width","height"),a.position=e("top","left"),a.rPosition=e("right","bottom"),a=n(a,r.config||{}),a.scrollbar.margin=(a.scrollbarContainer.width-a.scrollbar.width)/2,a.scrollbar.hoverMargin=(a.scrollbarContainer.width-a.scrollbar.hoverWidth)/2;var c,d=angular.element(o[0].querySelector(".ngscroll-container")),u=angular.element(o[0].querySelector(".ngscroll-scrollbar-container")),b=angular.element(u.children()[0]),h=e(o[0].offsetHeight,o[0].offsetWidth),f=0;r.styles={scrollbar:{position:"absolute",cursor:"default",opacity:a.scrollbar.show?1:0,background:a.scrollbar.color,"border-radius":a.scrollbar.width/2+"px"},scrollbarContainer:{position:"absolute",transition:"background .3s ease-in-out","border-radius":a.scrollbarContainer.width/2+"px"}},b.css(a.rDimension,a.scrollbar.width+"px"),b.css(a.rPosition,a.scrollbar.margin+"px"),b.css(a.position,a.scrollbar.margin+"px"),u.css(a.rPosition,"0"),u.css(a.position,"0"),u.css(a.dimension,"100%"),u.css(a.rDimension,a.scrollbarContainer.width+"px");var g=function(){e(function(){d.css("height","auto"),f=d[0].scrollHeight||0},function(){f=0;for(var r=d.children(),o=0;r.length>o;o++)f+=r[o].offsetWidth})(),a.dragSpeedModifier=Math.max(1,1/(c/h)),d.css(a.dimension,f+"px"),h>=f?(f=h,o.addClass("no-scrollbar"),o.removeClass("has-scrollbar"),l()):(o.addClass("has-scrollbar"),o.removeClass("no-scrollbar"),a.scrollbar.show&&t()),c=h/f*h-2*a.scrollbar.margin,b.css(a.dimension,c+"px"),b.css("transition","opacity .3s ease-in-out, border-radius .1s linear, "+a.rDimension+" .1s linear, "+a.rPosition+" .1s linear"),null==a.scrollTo?s(0):"start"==a.scrollTo?i(0):"end"==a.scrollTo?i(-f+h):i(-parseInt(a.scrollTo))};a.autoResize===!0&&(d.on("DOMNodeInserted",g),d.on("DOMNodeRemoved",g)),r.$on("recalculateMBScrollbars",function(){setTimeout(function(){g()},5)}),d.on("mousewheel",function(r){r.preventDefault(),void 0!=r.originalEvent&&(r=r.originalEvent);var o=e(r.wheelDeltaY||r.wheelDelta,r.wheelDeltaX||r.wheelDeltaY||r.wheelDelta);s(o)}),window.navigator.userAgent.toLowerCase().indexOf("firefox")>=0&&d.on("wheel",function(r){r.preventDefault(),void 0!=r.originalEvent&&(r=r.originalEvent);var o=e(r.deltaY,r.deltaX>0?r.deltaX:r.deltaY);return s(-o*a.firefoxModifier),!1});var m,p;b.on("mousedown",function(r){return r.preventDefault(),m=!0,angular.element(document).on("mouseup",function(){m=!1,a.scrollbar.show||l()}),p=e(r.screenY,r.screenX),!1}),angular.element(document).on("mousemove",function(r){if(m){r.preventDefault();var o=e(r.screenY,r.screenX)-p;o*=a.dragSpeedModifier,p+=o*(c/h),s(-o)}}),a.scrollbar.show||(o.on("mouseenter",t),u.on("mouseenter",t),o.on("mouseleave",function(){m||l()})),u.on("mouseenter",function(){u.css("background",a.scrollbarContainer.color),b.css(a.rDimension,a.scrollbar.hoverWidth+"px"),b.css(a.rPosition,a.scrollbar.hoverMargin+"px"),b.css("border-radius",a.scrollbar.hoverWidth/2+"px")}),u.on("mouseleave",function(){u.css("background","none"),b.css(a.rDimension,a.scrollbar.width+"px"),b.css(a.rPosition,a.scrollbar.margin+"px"),b.css("border-radius",a.scrollbar.width/2+"px")}),g()}}}).service("mbScrollbar",function(){this.recalculate=function(r){setTimeout(function(){r.$broadcast("recalculateMBScrollbars")},5)}});