/*
 * mb-scrollbar v2.0.0
 * Plugin for AngularJS
 * (c) 2014 Matthew Balmer http://mattbalmer.com
 * License: MIT
 */
angular.module("mb-scrollbar",[]).directive("mbScrollbar",function(){return{restrict:"A",transclude:!0,scope:{config:"=mbScrollbar"},template:"<div class='ngscroll-resizable' style='position: relative; width: 100%; height: 100%;'> <div class='ngscroll-container' style='width: 100%; height: 100%;' ng-transclude></div> <div class='ngscroll-scrollbar-container' ng-style='styles.scrollbarContainer'><div class='ngscroll-scrollbar' ng-style='styles.scrollbar'></div></div> </div>",link:function(r,o){function e(r,o){return"horizontal"==t.direction?o:r}function n(r,o){for(var e in o)(o||{}).hasOwnProperty(e)&&(r||{}).hasOwnProperty(e)&&(r[e]="object"==typeof r[e]?n(r[e],o[e]):o[e]);return r}function i(r){var o="margin-"+t.position,e=parseInt(a.css(o)||0)+r;s(e)}function s(r){var o="margin-"+t.position,n=Math.min(0,Math.max(r,-b+d)),i=-n/b;a.css(o,n+"px"),u.css(t.position,i*d+t.scrollbar.margin+"px"),c.css(o,e(-n,0)+"px")}var t={autoResize:!1,direction:(r.config||{}).direction||"vertical",scrollbar:{width:6,hoverWidth:8,color:"rgba(0,0,0,.6)",show:!1},scrollbarContainer:{width:12,color:"rgba(0,0,0,.1)"},dragSpeedModifier:1,firefoxModifier:40,scrollTo:(r.config||{}).scrollTo||null};t.dimension=e("height","width"),t.rDimension=e("width","height"),t.position=e("top","left"),t.rPosition=e("right","bottom"),t=n(t,r.config||{}),t.scrollbar.margin=(t.scrollbarContainer.width-t.scrollbar.width)/2,t.scrollbar.hoverMargin=(t.scrollbarContainer.width-t.scrollbar.hoverWidth)/2;var l,a=angular.element(o[0].querySelector(".ngscroll-container")),c=angular.element(o[0].querySelector(".ngscroll-scrollbar-container")),u=angular.element(c.children()[0]),d=e(o[0].offsetHeight,o[0].offsetWidth),b=0;r.styles={scrollbar:{position:"absolute",cursor:"default",opacity:t.scrollbar.show?1:0,background:t.scrollbar.color,"border-radius":t.scrollbar.width/2+"px"},scrollbarContainer:{position:"absolute",transition:"background .3s ease-in-out","border-radius":t.scrollbarContainer.width/2+"px"}},u.css(t.rDimension,t.scrollbar.width+"px"),u.css(t.rPosition,t.scrollbar.margin+"px"),u.css(t.position,t.scrollbar.margin+"px"),c.css(t.rPosition,"0"),c.css(t.position,"0"),c.css(t.dimension,"100%"),c.css(t.rDimension,t.scrollbarContainer.width+"px");var h=function(){e(function(){a.css("height","auto"),b=a[0].scrollHeight||0},function(){b=0;for(var r=a.children(),o=0;r.length>o;o++)b+=r[o].offsetWidth})(),t.dragSpeedModifier=Math.max(1,1/(l/d)),a.css(t.dimension,b+"px"),d>b&&(b=d),l=d/b*d-2*t.scrollbar.margin,u.css(t.dimension,l+"px"),u.css("transition","opacity .3s ease-in-out, border-radius .1s linear, "+t.rDimension+" .1s linear, "+t.rPosition+" .1s linear"),null==t.scrollTo?i(0):"start"==t.scrollTo?s(0):"end"==t.scrollTo?s(-b+d):s(-parseInt(t.scrollTo))};if("function"==typeof MutationObserver){var f=new MutationObserver(function(){setTimeout(function(){h()},200)});f.observe(o[0],{childList:!0,subtree:!0,characterData:!0,attributes:!0})}else t.autoResize===!0&&(a.on("DOMNodeInserted",h),a.on("DOMNodeRemoved",h));r.$on("recalculateMBScrollbars",function(){setTimeout(function(){h()},5)}),a.on("mousewheel",function(r){r.preventDefault(),void 0!=r.originalEvent&&(r=r.originalEvent);var o=e(r.wheelDeltaY||r.wheelDelta,r.wheelDeltaX||r.wheelDeltaY||r.wheelDelta);i(o)}),window.navigator.userAgent.toLowerCase().indexOf("firefox")>=0&&a.on("wheel",function(r){r.preventDefault(),void 0!=r.originalEvent&&(r=r.originalEvent);var o=e(r.deltaY,r.deltaX>0?r.deltaX:r.deltaY);return i(-o*t.firefoxModifier),!1});var g,m;u.on("mousedown",function(r){return r.preventDefault(),g=!0,angular.element(document).on("mouseup",function(){g=!1,t.scrollbar.show||u.css("opacity",0)}),m=e(r.screenY,r.screenX),!1}),angular.element(document).on("mousemove",function(r){if(g){r.preventDefault();var o=e(r.screenY,r.screenX)-m;o*=t.dragSpeedModifier,m+=o*(l/d),i(-o)}}),t.scrollbar.show||(o.on("mouseenter",function(){u.css("opacity",1)}),c.on("mouseenter",function(){u.css("opacity",1)}),o.on("mouseleave",function(){g||u.css("opacity",0)})),c.on("mouseenter",function(){c.css("background",t.scrollbarContainer.color),u.css(t.rDimension,t.scrollbar.hoverWidth+"px"),u.css(t.rPosition,t.scrollbar.hoverMargin+"px"),u.css("border-radius",t.scrollbar.hoverWidth/2+"px")}),c.on("mouseleave",function(){c.css("background","none"),u.css(t.rDimension,t.scrollbar.width+"px"),u.css(t.rPosition,t.scrollbar.margin+"px"),u.css("border-radius",t.scrollbar.width/2+"px")}),h()}}}).service("mbScrollbar",function(){this.recalculate=function(r){setTimeout(function(){r.$broadcast("recalculateMBScrollbars")},5)}});